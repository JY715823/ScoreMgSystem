<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>系统首页</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../component/pear/css/pear.css" />
    <link rel="stylesheet" href="../../admin/css/other/console.css" />
    <style>
        .welcome-card {
            background: linear-gradient(to right, #1E9FFF, #009688);
            color: #fff;
            padding: 30px;
            border-radius: 4px;
            margin-bottom: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .welcome-title { font-size: 24px; font-weight: 500; margin-bottom: 10px; }
        .welcome-date { font-size: 14px; opacity: 0.8; }

        .data-card {
            background: #fff;
            padding: 25px;
            border-radius: 4px;
            box-shadow: 0 1px 2px 0 rgba(0,0,0,.05);
            text-align: center;
            transition: all 0.3s;
        }
        .data-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .data-num { font-size: 32px; font-weight: bold; color: #333; margin: 10px 0; }
        .data-label { color: #888; font-size: 14px; }
        .data-icon { font-size: 40px; margin-bottom: 10px; display: inline-block; }

        .notice-item {
            padding: 15px 0;
            border-bottom: 1px dashed #eee;
            color: #666;
            display: flex;
            justify-content: space-between;
        }
        .notice-item:last-child { border-bottom: none; }
        .notice-tag {
            background: #f2f2f2; color: #888; padding: 2px 8px; border-radius: 2px; font-size: 12px; margin-right: 10px;
        }
    </style>
</head>
<body class="pear-container">

<div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
        <div class="welcome-card">
            <div class="welcome-title">欢迎回来，<span id="user-name">加载中...</span></div>
            <div class="welcome-date" id="current-date">正在获取时间...</div>
        </div>
    </div>
</div>

<div class="layui-row layui-col-space15">
    <div class="layui-col-md4">
        <div class="data-card">
            <i class="layui-icon layui-icon-user data-icon" style="color: #1E9FFF;"></i>
            <div class="data-num" id="stat-student">0</div>
            <div class="data-label">学生总数 (人)</div>
        </div>
    </div>
    <div class="layui-col-md4">
        <div class="data-card">
            <i class="layui-icon layui-icon-read data-icon" style="color: #FFB800;"></i>
            <div class="data-num" id="stat-course">0</div>
            <div class="data-label">课程总数 (门)</div>
        </div>
    </div>
    <div class="layui-col-md4">
        <div class="data-card">
            <i class="layui-icon layui-icon-chart-screen data-icon" style="color: #FF5722;"></i>
            <div class="data-num" id="stat-gpa">0.00</div>
            <div class="data-label">全校平均绩点</div>
        </div>
    </div>
</div>

<div class="layui-row layui-col-space15">
    <div class="layui-col-md8">
        <div class="layui-card">
            <div class="layui-card-header">
                <i class="layui-icon layui-icon-speaker"></i> 系统公告
            </div>
            <div class="layui-card-body">
                <div class="notice-item">
                    <div><span class="notice-tag">通知</span> 2024-2025学年第一学期期末成绩录入工作已开始</div>
                    <span>12-25</span>
                </div>
                <div class="notice-item">
                    <div><span class="notice-tag">维护</span> 系统将于本周六晚 23:00 进行例行维护</div>
                    <span>12-24</span>
                </div>
                <div class="notice-item">
                    <div><span class="notice-tag">考试</span> 关于补考申请流程的说明</div>
                    <span>12-20</span>
                </div>
                <div class="notice-item">
                    <div><span class="notice-tag">安全</span> 请各位同学和老师定期修改密码</div>
                    <span>12-01</span>
                </div>
            </div>
        </div>
    </div>

    <div class="layui-col-md4">
        <div class="layui-card">
            <div class="layui-card-header">使用说明</div>
            <div class="layui-card-body" style="line-height: 24px; color: #666;">
                <p><b>管理员：</b>请在“系统管理”中进行学生档案维护、课程设置及成绩录入。</p>
                <hr style="margin: 10px 0;">
                <p><b>学生：</b>请点击“我的成绩”查看个人分数及绩点分析。</p>
                <br>
                <blockquote class="layui-elem-quote" style="border-left: 5px solid #009688;">
                    提示：绩点计算公式为 (分数-50)/10，不及格为0。
                </blockquote>
            </div>
        </div>
    </div>
</div>

<script src="../../component/layui/layui.js"></script>
<script src="../../component/pear/pear.js"></script>
<script>
    layui.use(['jquery'], function() {
        var $ = layui.jquery;

        // 1. 设置当前日期
        var now = new Date();
        var dateStr = now.getFullYear() + "年" + (now.getMonth() + 1) + "月" + now.getDate() + "日";
        $("#current-date").text("今天是 " + dateStr + "，祝您生活愉快！");

        // 2. 异步请求后端数据
        $.ajax({
            url: "/api/home/data",
            method: "GET",
            dataType: "json",
            success: function(res) {
                if(res.code === 0 && res.data) {
                    var d = res.data;

                    // 填充用户名
                    $("#user-name").text(d.username);

                    // 填充统计数据 (带简单的数字跳动效果可选，这里直接显示)
                    $("#stat-student").text(d.studentCount);
                    $("#stat-course").text(d.courseCount);
                    $("#stat-gpa").text(d.schoolGpa);
                }
            },
            error: function() {
                $("#user-name").text("获取失败");
            }
        });
    });
</script>
</body>
</html>