<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>é¦–é¡µ</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../component/pear/css/pear.css" />
    <link rel="stylesheet" href="../../admin/css/other/console.css" />
    <style>
        /* è‡ªå®šä¹‰æ ·å¼ï¼šè®©ç•Œé¢æ›´ç®€æ´å¤§æ°” */
        .welcome-card {
            background: linear-gradient(135deg, #1e9fff 0%, #40a9ff 100%);
            color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(30, 159, 255, 0.2);
            margin-bottom: 15px;
        }
        .welcome-title { font-size: 26px; font-weight: 500; margin-bottom: 10px; }
        .welcome-desc { font-size: 14px; opacity: 0.9; }

        .data-card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
            transition: all 0.3s;
        }
        .data-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .data-icon { font-size: 32px; margin-bottom: 10px; display: inline-block; }
        .data-num { font-size: 28px; font-weight: bold; color: #333; }
        .data-label { font-size: 14px; color: #888; margin-top: 5px; }

        /* éšè—ç±»ï¼Œç”¨äºæ§åˆ¶æƒé™æ˜¾ç¤º */
        .view-section { display: none; }
    </style>
</head>
<body class="pear-container">

<div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
        <div class="welcome-card">
            <div class="welcome-title" id="welcomeMsg">æ¬¢è¿å›æ¥ï¼ŒåŒå­¦ï¼</div>
            <div class="welcome-desc">ä»Šå¤©æ˜¯ <span id="currentDate"></span>ï¼Œæ–°çš„ä¸€å¤©ï¼Œç»§ç»­åŠ æ²¹ï¼</div>
        </div>
    </div>
</div>

<div id="admin-view" class="view-section">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md4">
            <div class="data-card">
                <i class="layui-icon layui-icon-user data-icon" style="color: #1e9fff;"></i>
                <div class="data-num">1,203</div>
                <div class="data-label">å­¦ç”Ÿæ€»æ•°</div>
            </div>
        </div>
        <div class="layui-col-md4">
            <div class="data-card">
                <i class="layui-icon layui-icon-read data-icon" style="color: #ffb800;"></i>
                <div class="data-num">42</div>
                <div class="data-label">è¯¾ç¨‹æ€»æ•°</div>
            </div>
        </div>
        <div class="layui-col-md4">
            <div class="data-card">
                <i class="layui-icon layui-icon-chart-screen data-icon" style="color: #ff5722;"></i>
                <div class="data-num">78.5</div>
                <div class="data-label">å…¨æ ¡å¹³å‡åˆ†</div>
            </div>
        </div>
    </div>
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">å…¨æ ¡å„ç§‘å¹³å‡åˆ†åˆ†æ</div>
                <div class="layui-card-body">
                    <div id="chart-admin-course" style="width: 100%; height: 400px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="student-view" class="view-section">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md6">
            <div class="data-card">
                <i class="layui-icon layui-icon-star data-icon" style="color: #ffb800;"></i>
                <div class="data-num">82.5</div>
                <div class="data-label">æˆ‘çš„å¹³å‡åˆ†</div>
            </div>
        </div>
        <div class="layui-col-md6">
            <div class="data-card">
                <i class="layui-icon layui-icon-trophy data-icon" style="color: #ff5722;"></i>
                <div class="data-num">95</div>
                <div class="data-label">æˆ‘çš„æœ€é«˜åˆ† (Javaç¨‹åºè®¾è®¡)</div>
            </div>
        </div>
    </div>
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">æˆ‘çš„æˆç»©æ¦‚è§ˆ</div>
                <div class="layui-card-body">
                    <div id="chart-student-score" style="width: 100%; height: 400px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="../../component/layui/layui.js"></script>
<script src="../../component/pear/pear.js"></script>
<script>
    layui.use(['layer', 'echarts', 'jquery'], function() {
        var $ = layui.jquery;
        var echarts = layui.echarts;

        // ============================================
        // 1. è®¾ç½®æ—¥æœŸå’Œæ¬¢è¿è¯­
        // ============================================
        var now = new Date();
        $("#currentDate").text(now.getFullYear() + "å¹´" + (now.getMonth() + 1) + "æœˆ" + now.getDate() + "æ—¥");

        // ============================================
        // 2. æ¨¡æ‹Ÿåˆ¤æ–­èº«ä»½ (é‡ç‚¹çœ‹è¿™é‡Œï¼)
        // ============================================
        // âš ï¸ çœŸå®å¼€å‘ä¸­ï¼Œä½ éœ€è¦è¯·æ±‚åç«¯ API: /api/login/info è·å–å½“å‰ç”¨æˆ·èº«ä»½
        // è¿™é‡Œä¸ºäº†æ¼”ç¤ºæ•ˆæœï¼Œæˆ‘ä»¬é»˜è®¤è®¾ä¸º 1 (ç®¡ç†å‘˜)ã€‚
        // ä½ å¯ä»¥æ‰‹åŠ¨æŠŠè¿™é‡Œæ”¹æˆ 2 (å­¦ç”Ÿ) æ¥æŸ¥çœ‹å­¦ç”Ÿè§†å›¾çš„æ•ˆæœã€‚

        var userType = 1; // <--- ğŸ”´ æ”¹è¿™é‡Œï¼š 1=ç®¡ç†å‘˜, 2=å­¦ç”Ÿ

        // å°è¯•ä» localStorage è·å–ï¼ˆå¦‚æœä½ ä¹‹å‰ç™»å½•è¿‡ï¼‰
        // var cachedUserType = localStorage.getItem("userType");
        // if(cachedUserType) userType = parseInt(cachedUserType);

        if (userType === 1) {
            $("#admin-view").show();
            $("#welcomeMsg").text("æ¬¢è¿å›æ¥ï¼Œç®¡ç†å‘˜ï¼");
            renderAdminCharts();
        } else {
            $("#student-view").show();
            $("#welcomeMsg").text("æ¬¢è¿å›æ¥ï¼ŒåŒå­¦ï¼");
            renderStudentCharts();
        }

        // ============================================
        // 3. æ¸²æŸ“å›¾è¡¨ - ç®¡ç†å‘˜
        // ============================================
        function renderAdminCharts() {
            var myChart = echarts.init(document.getElementById('chart-admin-course'));
            var option = {
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: {
                    type: 'category',
                    data: ['Javaç¨‹åºè®¾è®¡', 'æ•°æ®ç»“æ„', 'æ“ä½œç³»ç»Ÿ', 'è®¡ç®—æœºç½‘ç»œ', 'æ•°æ®åº“åŸç†', 'é«˜ç­‰æ•°å­¦'],
                    axisTick: { alignWithLabel: true }
                },
                yAxis: { type: 'value', name: 'å¹³å‡åˆ†' },
                series: [{
                    name: 'å¹³å‡åˆ†',
                    type: 'bar',
                    barWidth: '40%',
                    data: [78, 85, 72, 80, 88, 65], // æ¨¡æ‹Ÿæ•°æ®
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: '#83bff6' },
                            { offset: 0.5, color: '#188df0' },
                            { offset: 1, color: '#188df0' }
                        ])
                    }
                }]
            };
            myChart.setOption(option);
            window.onresize = function() { myChart.resize(); }
        }

        // ============================================
        // 4. æ¸²æŸ“å›¾è¡¨ - å­¦ç”Ÿ
        // ============================================
        function renderStudentCharts() {
            var myChart = echarts.init(document.getElementById('chart-student-score'));
            var option = {
                title: { text: '' },
                tooltip: { trigger: 'axis' },
                legend: { data: ['æˆ‘çš„æˆç»©', 'å¹³å‡æˆç»©'], bottom: 0 },
                grid: { left: '3%', right: '4%', bottom: '10%', containLabel: true },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: ['Javaç¨‹åºè®¾è®¡', 'æ•°æ®ç»“æ„', 'æ“ä½œç³»ç»Ÿ', 'è®¡ç®—æœºç½‘ç»œ', 'æ•°æ®åº“åŸç†', 'é«˜ç­‰æ•°å­¦']
                },
                yAxis: { type: 'value', max: 100 },
                series: [
                    {
                        name: 'æˆ‘çš„æˆç»©',
                        type: 'line',
                        data: [95, 88, 76, 85, 92, 70], // æ¨¡æ‹Ÿæ•°æ®ï¼šæˆ‘çš„æˆç»©
                        smooth: true,
                        itemStyle: { color: '#ffb800' },
                        areaStyle: { opacity: 0.2 }
                    },
                    {
                        name: 'å¹³å‡æˆç»©',
                        type: 'line',
                        data: [78, 85, 72, 80, 88, 65], // æ¨¡æ‹Ÿæ•°æ®ï¼šå¹³å‡æˆç»©
                        smooth: true,
                        lineStyle: { type: 'dashed' },
                        itemStyle: { color: '#888' }
                    }
                ]
            };
            myChart.setOption(option);
            window.onresize = function() { myChart.resize(); }
        }

    });
</script>
</body>
</html>